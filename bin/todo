#!/usr/bin/env ruby

require_relative '../lib/todo-cli'

class TodoBinary
  def initialize
    @app = Todo::App.new
  end

  def repl
    while line = Readline.readline("todo> ".colorize(:cyan), true)
      route_input(line)
    end
  end

  def route_input(input)
    case input.split[0]
    when "a", "add"
      @app.create_todo(input.sub(/(a|add)/, ''))
    when "d", "del"
      @app.delete_todo(input.sub(/(d|del)/, ''))
    when "e", "edit"
      @app.edit_todo(input.sub(/(e|edit)/, ''))
    when "c", "complete"
      @app.complete_todo(input.sub(/(c|complete)/, ''))
    when "u", "uncomplete"
      @app.uncomplete_todo(input.sub(/(u|uncomplete)/, ''))
    when "l", "list"
      @app.list_todos(input)
    when "t", "today"
      @app.list_todos("l due today")
    else
      repl
    end
  end
end

TodoBinary.new.route_input(ARGV.join(' '))
